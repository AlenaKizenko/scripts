library(ggplot2)
library(topGO)
library(RColorBrewer)
#------CR1 Hydra vulgaris-----------------------
geneID2GO = readMappings(file = '/Users/alenakizenko/Documents/PhD/hydra_vulgaris_chrom/GO_annotation/reformatted_go.csv')
geneUniverse <- names(geneID2GO)
#------------------------Gene Ontology mapping------------------------------------------------------------------
GO_analysis = function(genesOfInterest) {
genesOfInterest <- as.character(unique(genesOfInterest$Gene))
geneList <- factor(as.integer(geneUniverse %in% genesOfInterest))
names(geneList) <- geneUniverse
myGOdata <- new("topGOdata", description="My project", ontology="CC", allGenes=geneList,  annot = annFUN.gene2GO, gene2GO = geneID2GO)
test.stat <- new("parentChild", testStatistic = GOFisherTest, name = "Fisher test")
resultFisher <- getSigGroups(myGOdata, test.stat)
pvalFis = score(resultFisher)
allRes <- GenTable(myGOdata, classicFisher = resultFisher, orderBy = "resultFisher", ranksOf = "classicFisher", topNodes = 10)
allRes$classicFisher = as.numeric(allRes$classicFisher)
return(allRes)
}
df_brown = read.csv('/Users/alenakizenko/Documents/PhD/project/hydra_vulgaris_chrom/genome_annotation_CR1/all_repeats_gene_annotation_filtered_dist_pos_neg.tsv',
sep = '\t', stringsAsFactors = F, header = F)
View(head(df_brown))
df_brown = read.delim2('/Users/alenakizenko/Documents/PhD/project/hydra_vulgaris_chrom/genome_annotation_CR1/all_repeats_gene_annotation_filtered_dist_pos_neg.tsv',
sep = '\t', header = F)
View(df_brown)
df_brown = read.delim2('/Users/alenakizenko/Documents/PhD/project/hydra_vulgaris_chrom/genome_annotation_CR1/all_repeats_gene_annotation_filtered_dist.tsv',
sep = '\t', header = F)
View(head(df_brown))
cr1 = df_brown[grepl('LINE/CR1', df_brown$V3), ]
hist(cr1$V19)
#cr1 = subset(cr1, V19 <= 10000 & V19 >= -10000)
cr1 = subset(cr1, V19 <= 10000)
hist(cr1$V19)
#-----------cr1 all genes analysis---------------
colnames(cr1)[20] = 'Gene'
res_cr1 = GO_analysis(cr1)
geneID2GO = readMappings(file = '/Users/alenakizenko/Documents/PhD/project/hydra_vulgaris_chrom/GO_annotation/reformatted_go.csv')
geneUniverse <- names(geneID2GO)
res_cr1 = GO_analysis(cr1)
go_cr1_hvul = ggplot(res_cr1, aes(reorder(Term, Significant), -log10(classicFisher),
fill = Significant)) +
geom_bar(stat = 'identity', color = 'gray8', fill = brewer.pal(11, 'Spectral')[2]) +
geom_hline(yintercept = c(-log10(0.05)),linetype="dashed") +
geom_hline(yintercept = c(-log10(0.01)),linetype="dashed") +
coord_flip() +
theme_bw() +
theme(plot.title = element_text(hjust = 1, size = 18, face = 'bold'),
axis.text.x = element_text(size=18,color = "black"),
axis.text.y = element_text(size=18,color = "black"),
axis.title.x = element_text(size=18,color = "black"),
axis.title.y = element_text(size=18,color = "black"),
strip.text.x = element_text(size = 18,colour = "black"),
legend.text = element_text(size=18,color = "black"),
legend.title = element_text(size = 18,color = "black")) +
labs(title = 'Gene ontology of Hydra vulgaris genes nearest to CR1 repeats (upstream)',
x = '', y = '-log10(p-value)',
fill = 'Gene number') +
geom_text(aes(label = Significant),
size = 6, hjust=1, vjust=1)+
scale_y_continuous(breaks=seq(0, 6, 1), limits=c(0, 7))
go_cr1_hvul
go_cr1_hvul = ggplot(res_cr1, aes(reorder(Term, Significant), -log10(classicFisher),
fill = Significant)) +
geom_bar(stat = 'identity', color = 'gray8', alpha = 0.8, fill = brewer.pal(11, 'Spectral')[2]) +
geom_hline(yintercept = c(-log10(0.05)),linetype="dashed") +
geom_hline(yintercept = c(-log10(0.01)),linetype="dashed") +
coord_flip() +
theme_bw() +
theme(plot.title = element_text(hjust = 1, size = 18, face = 'bold'),
axis.text.x = element_text(size=18,color = "black"),
axis.text.y = element_text(size=18,color = "black"),
axis.title.x = element_text(size=18,color = "black"),
axis.title.y = element_text(size=18,color = "black"),
strip.text.x = element_text(size = 18,colour = "black"),
legend.text = element_text(size=18,color = "black"),
legend.title = element_text(size = 18,color = "black")) +
labs(title = 'Gene ontology of Hydra vulgaris genes nearest to CR1 repeats (upstream)',
x = '', y = '-log10(p-value)',
fill = 'Gene number') +
geom_text(aes(label = Significant),
size = 6, hjust=1, vjust=1)+
scale_y_continuous(breaks=seq(0, 6, 1), limits=c(0, 7))
go_cr1_hvul
go_cr1_hvul = ggplot(res_cr1, aes(reorder(Term, Significant), -log10(classicFisher),
fill = Significant)) +
geom_bar(stat = 'identity', color = 'gray8', alpha = 0.8, fill = brewer.pal(11, 'Spectral')[2]) +
geom_hline(yintercept = c(-log10(0.05)),linetype="dashed") +
geom_hline(yintercept = c(-log10(0.01)),linetype="dashed") +
coord_flip() +
theme_bw() +
theme(plot.title = element_text(hjust = 1, size = 18, face = 'bold'),
axis.text.x = element_text(size=18,color = "black"),
axis.text.y = element_text(size=18,color = "black"),
axis.title.x = element_text(size=18,color = "black"),
axis.title.y = element_text(size=18,color = "black"),
strip.text.x = element_text(size = 18,colour = "black"),
legend.text = element_text(size=18,color = "black"),
legend.title = element_text(size = 18,color = "black")) +
labs(title = '',
x = '', y = '-log10(p-value)',
fill = 'Gene number') +
geom_text(aes(label = Significant),
size = 6, hjust=1, vjust=1)+
scale_y_continuous(breaks=seq(0, 6, 1), limits=c(0, 7))
ggsave(plot = go_cr1_hvul, filename = '/Users/alenakizenko/Documents/PhD/project/pictures/go_cr1_hvul.tiff',
device = 'tiff', width = 10, height = 10)
